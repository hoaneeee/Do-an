<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="_layout :: html(~{::title}, ~{::style}, ~{::section})">
<head>
    <title>Cart</title>
    <style>
        .cart-card{ border-radius:16px; box-shadow:0 10px 30px rgba(16,24,40,.08); border:0 }
        .price{ font-weight:800 }
        .empty{ border-radius:14px; border:1px dashed #d0d5dd; background:#fafafa }
    </style>
</head>
<body>
<section class="container">
    <h3 class="fw-bold mb-3">Giỏ hàng</h3>

    <!-- Empty -->
    <div class="empty p-5 text-center" th:if="${cart.lines.isEmpty()}">
        Giỏ hàng đang trống. <a href="/">Tiếp tục xem sự kiện</a>.
    </div>

    <!-- List -->
    <div class="card cart-card" th:if="${!cart.lines.isEmpty()}">
        <div class="table-responsive">
            <table class="table align-middle m-0">
                <thead class="table-light">
                <tr>
                    <th>Sự kiện</th>
                    <th>Loại vé</th>
                    <th class="text-center" style="width:140px">Số lượng</th>
                    <th class="text-end" style="width:160px">Đơn giá</th>
                    <th class="text-end" style="width:160px">Thành tiền</th>
                    <th style="width:60px"></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="l : ${cart.lines}">
                    <td th:text="${l.eventTitle}">Concert A</td>
                    <td th:text="${l.ticketTypeName}">Vé thường</td>
                    <td class="text-center" th:text="${l.qty}">1</td>
                    <td class="text-end">
                        <span class="price" th:text="${#numbers.formatInteger(l.unitPrice,0)}"></span> đ
                    </td>
                    <td class="text-end">
                        <span class="price" th:text="${#numbers.formatInteger(l.lineTotal(),0)}"></span> đ
                    </td>
                    <td class="text-end">
                        <form method="post" th:action="@{/cart/remove}">
                            <input type="hidden" name="ticketTypeId" th:value="${l.ticketTypeId}">
                            <button class="btn btn-sm btn-outline-danger" title="Xoá">
                                <i class="bi bi-x-lg"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="p-3 d-flex justify-content-between align-items-center">
            <form method="post" th:action="@{/cart/clear}">
                <button class="btn btn-outline-secondary">Xoá toàn bộ</button>
            </form>

            <div class="h5 m-0">
                Tổng cộng:
                <span class="price" th:text="${#numbers.formatInteger(cart.grandTotal(),0)}"></span> đ
            </div>
        </div>
    </div>

    <div class="mt-3 d-flex justify-content-between" th:if="${!cart.lines.isEmpty()}">
        <a href="/" class="btn btn-link"><i class="bi bi-arrow-left"></i> Tiếp tục xem sự kiện</a>
        <!-- Checkout sẽ làm ở bước tiếp -->
        <a href="/checkout" class="btn btn-primary btn-lg">Tiếp tục thanh toán</a>
    </div>
</section>
</body>
</html>
